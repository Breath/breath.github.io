(this["webpackJsonpokami-viewer"]=this["webpackJsonpokami-viewer"]||[]).push([[0],{65:function(e,t,a){},71:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(13),c=a.n(r),o=a(9),i=(a(63),a(64),a(65),a(17)),s=a(7),u=a(75),m=a(77),p=a(25),d=a(27),g=function(){return l.a.createElement(u.a,null,l.a.createElement(u.a.Toggle,{"aria-controls":"basic-navbar-nav"}),l.a.createElement(u.a.Collapse,{id:"basic-navbar-nav"},l.a.createElement(m.a,{className:"mr-auto"},l.a.createElement(m.a.Item,null,l.a.createElement(m.a.Link,{as:i.b,to:"/"},l.a.createElement(p.a,{icon:d.b})," Home")),l.a.createElement(m.a.Item,null,l.a.createElement(m.a.Link,{as:i.b,to:"/source"},l.a.createElement(p.a,{icon:d.a})," Source")),l.a.createElement(m.a.Item,null,l.a.createElement(m.a.Link,{as:i.b,to:"/blacklist"},l.a.createElement(p.a,{icon:d.d})," Blacklist")),l.a.createElement(m.a.Item,null,l.a.createElement(m.a.Link,{as:i.b,to:"/about"},l.a.createElement(p.a,{icon:d.c})," About")))))},b=a(6),f=a(14),E=a(31),h={e621:{name:"e621",display:"e621",descriptors:["furry","nsfw"],url:{base:"https://e621.net",post:"https://e621.net/posts.json",params:{tags:"tags",page:"page",limit:"limit"}},posts:["posts"],file:{post:["id"],preview:["preview","url"],full:["file","url"]},tags:{general:["tags","general"],character:["tags","character"],copyright:["tags","copyright"],artist:["tags","artist"],meta:["tags","meta"],other:[["tags","species"],["tags","invalid"],["tags","lore"]]}},danbooru:{name:"danbooru",display:"Danbooru",descriptors:["anime","nsfw"],url:{base:"https://danbooru.donmai.us",post:"https://danbooru.donmai.us/posts.json",params:{tags:"tags",page:"page",limit:"limit"}},posts:[],file:{post:["id"],preview:["preview_file_url"],full:["file_url"]},tags:{general:["tag_string_general"],character:["tag_string_character"],copyright:["tag_string_copyright"],artist:["tag_string_artist"],meta:["tag_string_meta"],other:[]}}},v={posts:[],config:"e621",blacklist:[]};var y=Object(E.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"config/modify":return Object(b.a)(Object(b.a)({},e),{},{config:t.payload});case"posts/set":return Object(b.a)(Object(b.a)({},e),{},{posts:t.payload});case"blacklist/set":return Object(b.a)(Object(b.a)({},e),{},{blacklist:t.payload});default:return e}})),j=a(18),O=function(e,t){for(var a=t,n=0;n<e.length;n++)a=a[e[n]];return a},k=function(e){var t=e.split("."),a=t[t.length-1];return["mp4","webm"].includes(a)?"video":"gif"===a?"gif":"swf"===a?"flash":"image"},w=function(e){var t=Object(o.c)((function(e){return e.config})),a=h[t],r=O(a.file.full,e.post),c=Object(n.useState)(r?{error:!1,post:O(a.file.post,e.post),full:r,preview:O(a.file.preview,e.post),type:k(r),displayFull:!1}:{error:!0}),i=Object(f.a)(c,2),s=i[0],u=i[1];if(s.error)return null;return l.a.createElement("div",{className:"post"},l.a.createElement("img",{src:s.displayFull?s.full:s.preview,className:s.type,onClick:function(){if("image"===s.type||"gif"===s.type)if(s.displayFull){var e=window.open(s.full);e&&(e.opener=null)}else u(Object(b.a)(Object(b.a)({},s),{},{displayFull:!0}));else{var t=window.open(s.full,"_blank","noopener,noreferrer");t&&(t.opener=null)}},onMouseDown:function(e){if(1===e.button){var t=window.open(s.full);t&&(t.opener=null)}}}))},C=a(74),L=a(73),S=function(e){var t=Object(n.useState)({tags:"rating:s",page:1,limit:25}),a=Object(f.a)(t,2),r=a[0],c=a[1];return l.a.createElement("div",{className:"container mt-5 mb-5"},l.a.createElement(C.a,{id:"search-form",onSubmit:e.doSearch},l.a.createElement(C.a.Group,{controlId:"tags"},l.a.createElement(C.a.Label,null,"Tags"),l.a.createElement(C.a.Control,{name:"tags",type:"text",value:r.tags,onChange:function(e){return c(Object(b.a)(Object(b.a)({},r),{},{tags:e.target.value}))}})),l.a.createElement(C.a.Group,{controlId:"page"},l.a.createElement(C.a.Label,null,"Page"),l.a.createElement(C.a.Control,{name:"page",type:"number",value:r.page,onChange:function(e){return c(Object(b.a)(Object(b.a)({},r),{},{page:e.target.value}))}})),l.a.createElement(C.a.Group,{controlId:"limit"},l.a.createElement(C.a.Label,null,"Limit"),l.a.createElement(C.a.Control,{name:"limit",type:"number",value:r.limit,onChange:function(e){return c(Object(b.a)(Object(b.a)({},r),{},{limit:e.target.value}))}})),l.a.createElement(L.a,{className:"mt-2",variant:"primary",type:"submit"},"Search")))},I=function(e){var t=Object(o.b)(),a=Object(n.useState)({error:null,hasSearched:!1,isLoaded:!1,blacklistedCount:0}),r=Object(f.a)(a,2),c=r[0],i=r[1],s=Object(o.c)((function(e){return e.posts})),u=Object(o.c)((function(e){return e.config})),m=Object(o.c)((function(e){return e.blacklist}));return l.a.createElement("div",null,l.a.createElement(S,{doSearch:function(e){e.preventDefault(),i({hasSearched:!0,isLoaded:!1});var a=h[u];fetch(a.url.post+"?"+new URLSearchParams({tags:e.target.tags.value,page:e.target.page.value,limit:e.target.limit.value})).then((function(e){return e.json()})).then((function(e){var n=O(a.posts,e),l=0,r=n.filter((function(e){var t=function(e,t){var a=[];Object.keys(t).forEach((function(e,n){if("other"===e)for(var l=0;l<t[e].length;l++)a.push(t[e][l]);else a.push(t[e])}));for(var n=[],l=0;l<a.length;l++){var r=O(a[l],e);n=[].concat(Object(j.a)(n),"string"===typeof r?Object(j.a)(r.split(" ")):Object(j.a)(r))}return n}(e,a.tags);return!m.some((function(e){return t.includes(e)}))||(l++,!1)}));i(Object(b.a)(Object(b.a)({},c),{},{isLoaded:!0,error:!1,blacklistedCount:l})),t({type:"posts/set",payload:r})}),(function(e){i(Object(b.a)(Object(b.a)({},c),{},{isLoaded:!0,error:!0})),t({type:"posts/set",payload:[]})}))}}),c.error&&l.a.createElement("div",{className:"error"},l.a.createElement("p",null,"Error: ",c.error.message)),!c.isLoaded&&c.hasSearched&&l.a.createElement("div",null,l.a.createElement("p",{className:"loading"},"Loading...")),c.isLoaded&&l.a.createElement("div",{id:"posts"},s.map((function(e){return l.a.createElement(w,{post:e})}))),c.isLoaded&&s.length<1&&!c.error&&l.a.createElement("div",{className:"error"},"No posts found. (",c.blacklistedCount," blacklisted posts)"))},N=function(){return l.a.createElement(I,null)},_=function(e){return l.a.createElement("div",{className:"container mt-5"},e.children)},A=a(76),x=function(e){var t=Object(o.b)(),a=Object(o.c)((function(e){return e.config})),n=Object(A.a)(["site"]),r=Object(f.a)(n,2),c=r[0],i=r[1];void 0!==c.site&&c.site!==a&&t({type:"config/modify",payload:e.name});return l.a.createElement("div",{className:"card",onClick:function(a){t({type:"config/modify",payload:e.name}),i("site",e.name,{path:"/"})}},l.a.createElement("div",{className:"card-body"},a===e.name?l.a.createElement("h2",null,l.a.createElement("strong",null,e.config.display)," (selected)"):l.a.createElement("h2",null,e.config.display),l.a.createElement("p",null,e.config.descriptors.join(", "))))},B=function(){return l.a.createElement(_,null,l.a.createElement("h1",null,"Source"),l.a.createElement("p",null,"Choose which site to get posts from."),Object.keys(h).map((function(e,t){return l.a.createElement(x,{key:e,name:e,config:h[e]})})))},D=a(78),F=a(45),T=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.blacklist})),a=Object(A.a)(["blacklist"]),n=Object(f.a)(a,2),r=n[0],c=n[1];if(t.length<1&&void 0!==r.blacklist){var i=r.blacklist.toString().split("|").filter((function(e){return""!==e&&void 0!==e}));i.length>0&&e({type:"blacklist/set",payload:i})}var s=function(a){a.preventDefault();var n=t.filter((function(e){return e!==a.target.innerHTML}));e({type:"blacklist/set",payload:n}),c("blacklist",n.join("|"),{path:"/"})};return l.a.createElement(_,null,l.a.createElement("h1",null,"Blacklist"),l.a.createElement("p",null,"Choose which tags you want to block from your search."),l.a.createElement(C.a,{onSubmit:function(a){a.preventDefault();for(var n=a.target.tags.value.split(" "),l=[],r=0;r<n.length;r++)""!==n[r]&&void 0!==n[r]&&(t.includes(n[r])?F.b.error("'".concat(n[r],"' is already blacklisted."),{position:"top-right",autoClose:5e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}):l.push(n[r]));var o=[].concat(Object(j.a)(t),l);e({type:"blacklist/set",payload:o}),c("blacklist",o.join("|"),{path:"/"}),a.target.tags.value=null},inline:!0},l.a.createElement(C.a.Group,{controlId:"formBlacklist"},l.a.createElement(C.a.Control,{className:"mb-2 mr-sm-2",type:"text",name:"tags",placeholder:"Tag(s) to blacklist..."}),l.a.createElement(L.a,{variant:"primary",type:"submit",className:"mb-2"},"Add"))),l.a.createElement(D.a,null,t.map((function(e,t){return l.a.createElement(D.a.Item,{variant:"danger",key:t,onClick:s},e)}))),l.a.createElement(F.a,null))},G="\u014ckami",P={github:"Breath"},U=function(){return l.a.createElement(_,null,l.a.createElement("h1",null,"About"),l.a.createElement("p",null,l.a.createElement("strong",null,G)," is a simple, easy to use alternative to most image gallery's UI. Made using React by ",function(e,t){var a,n=null;switch(e){case"github":n="https://github.com/"+t}return l.a.createElement("span",null,l.a.createElement("strong",null,l.a.createElement("a",{href:n},"@",t))," on ",l.a.createElement("strong",null,(a=e).charAt(0).toUpperCase()+a.slice(1)))}("github",P.github),"."),l.a.createElement("h3",null,"To-do"),l.a.createElement("ul",null,l.a.createElement("li",null,"Persistent search parameters."),l.a.createElement("li",null,"Add usage tab/section."),l.a.createElement("li",null,"Add ",l.a.createElement("code",null,"order:"),", ",l.a.createElement("code",null,"date:"),", etc sliders to search box."),l.a.createElement("li",null,"Create a logo (and add ",l.a.createElement("code",null,"favicon.ico")," / ",l.a.createElement("code",null,"logo192.png"),").")),l.a.createElement("h3",null,"v0.2.0"),l.a.createElement("ul",null,l.a.createElement("li",null,"Implemented blacklist functionality."),l.a.createElement("li",null,"Improved code for cookies."),l.a.createElement("li",null,"Added toast notifications (top right)."),l.a.createElement("li",null,"Added FontAwesome icons to the navbar.")),l.a.createElement("h3",null,"v0.1.1"),l.a.createElement("ul",null,l.a.createElement("li",null,"Renamed ",l.a.createElement("code",null,"Sites")," page to ",l.a.createElement("code",null,"Source"),"."),l.a.createElement("li",null,"Updated search box on the front page to be more centered.")),l.a.createElement("h3",null,"v0.1.0"),l.a.createElement("ul",null,l.a.createElement("li",null,"Initial release.")))},H=function(){return l.a.createElement(i.a,null,l.a.createElement(g,null),l.a.createElement(s.c,null,l.a.createElement(s.a,{exact:!0,path:"/",component:N}),l.a.createElement(s.a,{exact:!0,path:"/source",component:B}),l.a.createElement(s.a,{exact:!0,path:"/blacklist",component:T}),l.a.createElement(s.a,{exact:!0,path:"/about",component:U})))};c.a.render(l.a.createElement(o.a,{store:y},l.a.createElement(H,null)),document.getElementById("root"))}},[[71,1,2]]]);
//# sourceMappingURL=main.55bb83ce.chunk.js.map